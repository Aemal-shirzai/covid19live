<app-loading *ngIf="loading"></app-loading>
<div class="alert alert-danger text-center" *ngIf="error">
    <div class="alert-heading font-weight-bold d-inline-block">OOPS!!</div>
    <p class="d-inline-block ml-1">
        Could not load some of the data!
        <span class="alert-link span" (click)="refresh()">please try again.</span>
    </p>
</div>
<div class="container rounded bg-white">
    <h4 class="text-center p-4">Compare covid-19 statistics of countries</h4>
    <div class="dropdown-divider"></div>
    <div class="row box ">
        <div class="col-lg-4 field">
            <select class="form-control" [disabled]="loading || error" (change)="selectCountry('searchKeyOne')"
                [(ngModel)]="searchKeyOne">
                <option value="" disabled selected>Select Country...</option>
                <option *ngFor="let country of data" [ngValue]="country.country"
                    [disabled]="country.country  === searchKeyTwo">
                    {{country.country}}
                </option>
            </select>
        </div>
        <div class="col-lg-4 field">
            <select class="form-control" [disabled]="loading || error" (change)="selectCountry('searchKeyTwo')"
                [(ngModel)]="searchKeyTwo">
                <option disabled selected value="">Select Country...</option>
                <option *ngFor="let country of data" [ngValue]="country.country"
                    [disabled]="country.country  === searchKeyOne">
                    {{country.country}}
                </option>
            </select>
        </div>
        <div class="col-lg-2">
            <button class="btn btn-info" [disabled]="!searchKeyOneStatus || !searchKeyTwoStatus || comparing"
                (click)="compareData($event)">Compare</button>
        </div>
    </div>
    <div class="dropdown-divider" style="margin-bottom: 14px;"></div>
    <!-- Charts  -->

    <!-- Bar chart for total cases -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalCasesData">
        <h5 class="text-center mb-2">Total Cases Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalCasesData" [labels]="totalCasesLabels" [options]="barChartOptions"
                [legend]="chartsLegend" [chartType]="barChartType" [colors]="totalCasesColors" [plugins]="chartsPlugin">
            </canvas>
        </div>

    </div>
    <!--Total Cases linear chart for comparing historical Data -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalCasesHistoricalData">
        <h5 class="text-center mb-2">Total Cases Comparison Based On Date</h5>
        <div>
            <canvas baseChart [datasets]="totalCasesHistoricalData" [labels]="totalCasesHistoricalLabels"
                [options]="linearChartOptions" [legend]="chartsLegend" [chartType]="linearChartType"
                [colors]="totalCasesHistoricalColors" [plugins]="chartsPlugin">
            </canvas>
        </div>

    </div>
    <!-- Bar Chart for total deaths -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalDeathsData">
        <h5 class="text-center mb-2">Total Deaths Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalDeathsData" [labels]="totalDeathsLabels" [options]="barChartOptions"
                [legend]="chartsLegend" [chartType]="barChartType" [colors]="totalDeathsColors"
                [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!--Total deaths linear chart for comparing historical Data -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalDeathsHistoricalData">
        <h5 class="text-center mb-2">Total Deaths Comparison Based On Date</h5>
        <div>
            <canvas baseChart [datasets]="totalDeathsHistoricalData" [labels]="totalDeathsHistoricalLabels"
                [options]="linearChartOptions" [legend]="chartsLegend" [chartType]="linearChartType"
                [colors]="totalDeathsHistoricalColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!-- Bar Chart for total recovered -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalRecoveredData">
        <h5 class="text-center mb-2">Total Recovered Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalRecoveredData" [labels]="totalRecoveredLabels"
                [options]="barChartOptions" [legend]="chartsLegend" [chartType]="barChartType"
                [colors]="totalRecoveredColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!--Total recovered linear chart for comparing historical Data -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalRecoveredHistoricalData">
        <h5 class="text-center mb-2">Total Recovered Comparison Based On Date</h5>
        <div>
            <canvas baseChart [datasets]="totalRecoveredHistoricalData" [labels]="totalRecoveredHistoricalLabels"
                [options]="linearChartOptions" [legend]="chartsLegend" [chartType]="linearChartType"
                [colors]="totalRecoveredHistoricalColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!-- Bar Chart for New cases and new deaths recovered -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalNewsCasesDeathsData">
        <h5 class="text-center mb-2">Total New/Today Cases & New/Today Deaths Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalNewsCasesDeathsData" [labels]="totalNewsCasesDeathsLabels"
                [options]="barChartOptions" [legend]="chartsLegend" [chartType]="barChartType"
                [colors]="totalNewsCasesDeathsColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!-- Bar Chart for New cases and new deaths recovered -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalCasesandDeathsPerMillionData">
        <h5 class="text-center mb-2">Total Cases & Deaths Per One Million Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalCasesandDeathsPerMillionData" [labels]="totalCasesandDeathsPerMillionLabels"
                [options]="barChartOptions" [legend]="chartsLegend" [chartType]="barChartType"
                [colors]="totalCasesandDeathsPerMillionColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
    <!-- Bar Chart for New cases and new deaths recovered -->
    <div class="p-lg-2 pt-4 col-lg-10 col-sm-10 charts mb-5" *ngIf="totalTestsAndPerMillionData">
        <h5 class="text-center mb-2">Total Tests & Tests Per One Million Comparison</h5>
        <div>
            <canvas baseChart [datasets]="totalTestsAndPerMillionData" [labels]="totalTestsAndPerMillionLabels"
                [options]="barChartOptions" [legend]="chartsLegend" [chartType]="barChartType"
                [colors]="totalTestsAndPerMillionColors" [plugins]="chartsPlugin">
            </canvas>
        </div>
    </div>
</div>